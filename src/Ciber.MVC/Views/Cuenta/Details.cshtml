@model Cuenta
@{
    ViewData["Title"] = "Detalles de Cuenta";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-user"></i> @ViewData["Title"]</h2>
    <div>
        <a href="@Url.Action("Index")" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Volver
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Información de la Cuenta</h5>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-4">ID:</dt>
                    <dd class="col-sm-8">@Model.Ncuenta</dd>

                    <dt class="col-sm-4">Nombre:</dt>
                    <dd class="col-sm-8">@Model.Nombre</dd>

                    <dt class="col-sm-4">DNI:</dt>
                    <dd class="col-sm-8">@Model.Dni</dd>

                    <dt class="col-sm-4">Saldo:</dt>
                    <dd class="col-sm-8">
                        <span class="badge bg-@(Model.Saldo > 0 ? "success" : "warning") fs-6">
                            $@Model.Saldo.ToString("N2")
                        </span>
                    </dd>

                    <dt class="col-sm-4">Hora Registro:</dt>
                    <dd class="col-sm-8">@Model.HoraRegistrada.ToString(@"hh\:mm")</dd>

                    <dt class="col-sm-4">Estado:</dt>
                    <dd class="col-sm-8">
                        <span class="badge bg-@(Model.Activa ? "success" : "danger")">
                            @(Model.Activa ? "Activa" : "Inactiva")
                        </span>
                    </dd>
                </dl>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Acciones</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="@Url.Action("Recargar", new { id = Model.Ncuenta })" 
                       class="btn btn-success">
                        <i class="fas fa-money-bill-wave"></i> Recargar Saldo
                    </a>
                    <a href="@Url.Action("Edit", new { id = Model.Ncuenta })" 
                       class="btn btn-warning">
                        <i class="fas fa-edit"></i> Editar Cuenta
                    </a>
                    <a href="@Url.Action("Create", "Alquiler")" 
                       class="btn btn-primary">
                        <i class="fas fa-play"></i> Iniciar Alquiler
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-history"></i> Historial de Alquileres</h5>
            </div>
            <div class="card-body">
                @if (ViewBag.Historial != null && ((IEnumerable<dynamic>)ViewBag.Historial).Any())
                {
                    <div class="list-group">
                        @foreach (var historial in ViewBag.Historial)
                        {
                            <div class="list-group-item">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Máquina @historial.Nmaquina</h6>
                                    <small>$@(((decimal)historial.TotalPagar).ToString("N2"))</small>
                                </div>
                                <p class="mb-1">
                                    @historial.FechaInicio.ToString("dd/MM/yyyy HH:mm") - 
                                    @historial.FechaFin.ToString("dd/MM/yyyy HH:mm")
                                </p>
                                <small class="text-muted">Duración: @historial.TiempoUsado</small>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted">No hay historial de alquileres</p>
                }
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-exchange-alt"></i> Transacciones Recientes</h5>
            </div>
            <div class="card-body">
                @if (ViewBag.Transacciones != null && ((IEnumerable<dynamic>)ViewBag.Transacciones).Any())
                {
                    <div class="list-group">
                        @foreach (var transaccion in ViewBag.Transacciones)
                        {
                            <div class="list-group-item">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">@transaccion.Tipo</h6>
                                    <small class="text-@(transaccion.Tipo == "Recarga" ? "success" : "danger")">
                                        @(transaccion.Tipo == "Recarga" ? "+" : "-")$@(((decimal)transaccion.Monto).ToString("N2"))
                                    </small>
                                </div>
                                <p class="mb-1">@transaccion.Descripcion</p>
                                <small class="text-muted">@transaccion.Fecha.ToString("dd/MM/yyyy HH:mm")</small>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted">No hay transacciones registradas</p>
                }
            </div>
        </div>
    </div>
</div>